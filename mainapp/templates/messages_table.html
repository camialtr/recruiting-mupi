<section class="messages-table card overflow-hidden p-0"
         hx-trigger="refresh-messages from:document"
         hx-get="{% url 'admin' %}"
         hx-select=".messages-table"
         hx-swap="outerHTML">
  <div class="overflow-x-auto">
    <table class="w-full text-sm text-left">
      <thead class="text-xs text-secondary uppercase bg-surface border-b border-border">
        <tr>
          <th class="px-6 py-3 w-16">ID</th>
          <th class="px-6 py-3">Nome</th>
          <th class="px-6 py-3">Email</th>
          <th class="px-6 py-3 w-32 text-center">Lido</th>
          <th class="px-6 py-3 w-40">Data</th>
          <th class="px-6 py-3 text-right">Ações</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-border">
        {% for msg in messages %}
        <tr class="hover:bg-accent/5 transition-colors group">
          <td class="px-6 py-4 text-secondary font-mono text-xs">#{{ msg.id }}</td>
          <td class="px-6 py-4 font-medium text-primary">{{ msg.name }}</td>
          <td class="px-6 py-4 text-secondary">{{ msg.email }}</td>
          <td class="px-6 py-4 text-center">
            <button type="button"
                    class="toggle-read inline-flex items-center justify-center transition-opacity hover:opacity-80 focus:outline-none"
                    hx-post="{% url 'toggle_message_read' msg.pk %}"
                    hx-target="#read-text-{{ msg.pk }}"
                    hx-swap="outerHTML"
                    hx-select="unset">
              <span id="read-text-{{ msg.pk }}" class="px-2 py-1 rounded-full text-xs {% if msg.read %}bg-green-100 text-green-700 border border-green-200 dark:bg-green-900/30 dark:text-green-400 dark:border-green-900/50{% else %}bg-red-100 text-red-700 border border-red-200 dark:bg-red-900/30 dark:text-red-400 dark:border-red-900/50{% endif %}">
                {{ msg.read|yesno:"Sim,Não" }}
              </span>
            </button>
          </td>
          <td class="px-6 py-4 text-secondary whitespace-nowrap">{{ msg.formatted_date }}</td>
          <td class="px-6 py-4 text-right space-x-2">
            <button type="button" 
                    class="btn btn-secondary text-xs"
                    hx-get="{% url 'message_detail' msg.pk %}"
                    hx-target="#modal-content"
                    hx-swap="innerHTML"
                    hx-select="unset">Ver</button>
            {% if is_dev %}
            <button type="button" 
                    class="btn btn-secondary text-xs"
                    hx-get="{% url 'message_edit' msg.pk %}"
                    hx-target="#modal-content"
                    hx-swap="innerHTML"
                    hx-select="unset">Editar</button>
            <button type="button" 
                    class="btn btn-danger text-xs"
                    hx-get="{% url 'message_delete_confirm' msg.pk %}"
                    hx-target="#modal-content"
                    hx-swap="innerHTML"
                    hx-select="unset">Excluir</button>
            {% endif %}
          </td>
        </tr>
        {% empty %}
        <tr><td colspan="6" class="px-6 py-12 text-center text-secondary">Nenhuma mensagem encontrada.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>
